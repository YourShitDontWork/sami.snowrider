<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CELEX - Juegos</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: black;
      color: white;
      overflow-x: hidden;
    }

    canvas#snow {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
    }

    h1 {
      text-align: center;
      font-size: 3em;
      color: #0ff;
      text-shadow: 0 0 5px #0ff, 0 0 15px #0ff, 0 0 30px #0ff;
      font-weight: 600;
      margin: 20px 0;
    }

    input, button {
      font-size: 1em;
      padding: 10px;
      margin: 8px 0;
      width: 100%;
      border-radius: 6px;
      border: none;
    }

    button {
      cursor: pointer;
      background-color: #00bfa5;
      color: white;
    }

    button:hover {
      background-color: #009e8a;
    }

    .container {
      max-width: 320px;
      margin: auto;
      background: #222;
      padding: 20px;
      border-radius: 10px;
      display: none;
    }

    .container.active {
      display: block;
    }

    #userIcon {
      position: fixed;
      top: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #0ff;
      display: none;
      cursor: pointer;
    }

    #userPopup {
      display: none;
      position: fixed;
      top: 65px;
      right: 15px;
      background: #222;
      border-radius: 8px;
      padding: 15px;
      z-index: 10;
      box-shadow: 0 0 10px #0ff;
      color: white;
      width: 250px;
    }

    .grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin: 30px auto;
      max-width: 1200px;
      display: none;
    }

    .game {
      background: #333;
      padding: 10px;
      border-radius: 10px;
      width: 160px;
      text-align: center;
      transition: transform 0.2s;
    }

    .game:hover {
      transform: scale(1.05);
    }

    .game img {
      width: 100%;
      border-radius: 8px;
    }

    .game-title {
      margin-top: 10px;
      font-weight: 600;
    }

    .search-container {
      text-align: center;
      margin: 20px;
      display: none;
    }

    .search-container input {
      padding: 10px;
      width: 250px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
    }

    a {
      color: #0ff;
      cursor: pointer;
    }
  </style>
</head>
<body>

<canvas id="snow"></canvas>

<h1>CELEX - Juegos</h1>

<div id="userIcon" onclick="toggleUserPopup()">
  <img src="https://cdn-icons-png.flaticon.com/512/747/747376.png" style="width:100%; border-radius:50%;">
</div>
<div id="userPopup">
  <p><strong>Usuario:</strong> <span id="infoUser"></span></p>
  <p><strong>Registrado:</strong> <span id="infoRegistered"></span></p>
  <button onclick="logout()">Cerrar sesión</button>
</div>

<div id="loginContainer" class="container active">
  <h2>Iniciar Sesión</h2>
  <input type="text" id="loginUser" placeholder="Usuario" />
  <input type="password" id="loginPassword" placeholder="Contraseña" />
  <button onclick="login()">Entrar</button>
  <p>¿No tienes cuenta? <a onclick="showRegister()">Regístrate aquí</a></p>
</div>

<div id="registerContainer" class="container">
  <h2>Registro</h2>
  <input type="text" id="regUser" placeholder="Usuario" />
  <input type="password" id="regPass" placeholder="Contraseña" />
  <input type="password" id="regRepeat" placeholder="Repetir contraseña" />
  <button onclick="register()">Registrarse</button>
  <p>¿Ya tienes cuenta? <a onclick="showLogin()">Iniciar sesión aquí</a></p>
</div>

<div class="search-container" id="searchSection">
  <input type="text" id="searchInput" placeholder="Buscar juegos..." onkeyup="searchGames()">
</div>

<div class="grid" id="gameGrid">
  <!-- Tus juegos -->
  <div class="game"><a href="Slope-Source-code-main/index.html"><img src="Slope-Source-code-main/TemplateData/OIP.ico"><div class="game-title">Slope</div></a></div>
  <div class="game"><a href="Subway-Surfers/index.html"><img src="R.png"><div class="game-title">Subway Surfers</div></a></div>
  <div class="game"><a href="BurritoBison-main/index.html"><img src="BurritoBison-main/images/burrito-png.png"><div class="game-title">Burrito Bison</div></a></div>
  <div class="game"><a href="drive-mad-main/index.html"><img src="drive-mad-main/webapp/cover.jpg"><div class="game-title">Drive Mad</div></a></div>
  <div class="game"><a href="1v1lol/"><img src="1v1lol/logo.png"><div class="game-title">1v1.lol</div></a></div>
  <div class="game"><a href="bitlife/index.html"><img src="bitlife/logo.png"><div class="game-title">Bitlife</div></a></div>
  <div class="game"><a href="driftboss/index.html"><img src="driftboss/branding/logo1.png"><div class="game-title">Drift Boss</div></a></div>
  <div class="game"><a href="happywheels/index.html"><img src="happywheels/166950-HUdYLFwSkLSLQIwO.png"><div class="game-title">Happy Wheels</div></a></div>
  <div class="game"><a href="pacman/index.html"><img src="pacman/sejarah-penciptaan-game-legendaris-pac-man-10aXQ8DlD0.jpg"><div class="game-title">Pacman</div></a></div>
  <div class="game"><a href="skibidi1v100/index.html"><img src="skibidi1v100/logo.png"><div class="game-title">Skibidi 1v100</div></a></div>
  <div class="game"><a href="snowrider3d/index.html"><img src="snowrider3d/snow.png"><div class="game-title">Snow Rider 3D</div></a></div>
  <div class="game"><a href="volleyrandom/index.html"><img src="volleyrandom/splash.png"><div class="game-title">Volley Random</div></a></div>
</div>

<script>
  function showRegister() {
    document.getElementById('loginContainer').classList.remove('active');
    document.getElementById('registerContainer').classList.add('active');
  }

  function showLogin() {
    document.getElementById('registerContainer').classList.remove('active');
    document.getElementById('loginContainer').classList.add('active');
  }

  function register() {
    const username = document.getElementById('regUser').value.trim();
    const password = document.getElementById('regPass').value;
    const repeatPass = document.getElementById('regRepeat').value;

    if (!username || !password || !repeatPass) {
      alert('Completa todos los campos');
      return;
    }

    if (password !== repeatPass) {
      alert('Las contraseñas no coinciden');
      return;
    }

    let users = JSON.parse(localStorage.getItem('users') || '{}');
    if (users[username.toLowerCase()]) {
      alert('Nombre de usuario ya está en uso');
      return;
    }

    const now = new Date().toLocaleDateString();

    users[username.toLowerCase()] = {
      username,
      password,
      registered: now
    };

    localStorage.setItem('users', JSON.stringify(users));
    alert('Registro exitoso. Ahora inicia sesión.');
    showLogin();
  }

  function login() {
    const username = document.getElementById('loginUser').value.trim().toLowerCase();
    const password = document.getElementById('loginPassword').value;

    let users = JSON.parse(localStorage.getItem('users') || '{}');
    if (!users[username] || users[username].password !== password) {
      alert('Credenciales incorrectas');
      return;
    }

    localStorage.setItem('loggedInUser', username);
    showGames(username);
  }

  function logout() {
    localStorage.removeItem('loggedInUser');
    location.reload();
  }

  function showGames(username) {
    const users = JSON.parse(localStorage.getItem('users'));
    const user = users[username];

    document.getElementById('loginContainer').style.display = 'none';
    document.getElementById('registerContainer').style.display = 'none';
    document.getElementById('userIcon').style.display = 'block';
    document.getElementById('gameGrid').style.display = 'flex';
    document.getElementById('searchSection').style.display = 'block';

    document.getElementById('infoUser').textContent = user.username;
    document.getElementById('infoRegistered').textContent = user.registered;
  }

  function toggleUserPopup() {
    const popup = document.getElementById('userPopup');
    popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
  }

  function searchGames() {
    const input = document.getElementById('searchInput').value.toLowerCase();
    const games = document.querySelectorAll('.game');
    games.forEach(game => {
      const title = game.textContent.toLowerCase();
      game.style.display = title.includes(input) ? '' : 'none';
    });
  }

  // Autologin
  window.onload = () => {
    const user = localStorage.getItem('loggedInUser');
    if (user) showGames(user);
  };

  // Nieve animada
  const canvas = document.getElementById("snow");
  const ctx = canvas.getContext("2d");
  let w = canvas.width = window.innerWidth;
  let h = canvas.height = window.innerHeight;
  let flakes = [];

  function snow() {
    ctx.clearRect(0, 0, w, h);
    for (let i = 0; i < flakes.length; i++) {
      let f = flakes[i];
      f.y += f.speed;
      if (f.y > h) f.y = -10;
      ctx.beginPath();
      ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
      ctx.fillStyle = "white";
      ctx.fill();
    }
    requestAnimationFrame(snow);
  }

  function createFlakes() {
    for (let i = 0; i < 150; i++) {
      flakes.push({
        x: Math.random() * w,
        y: Math.random() * h,
        r: Math.random() * 3 + 1,
        speed: Math.random() + 0.5
      });
    }
  }

  createFlakes();
  snow();

  window.onresize = () => {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
  };
</script>

</body>
</html>
